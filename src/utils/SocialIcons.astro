---
import config from "virtual:starlight/user-config";
// @ts-expect-error - This is a custom Virtual Module
import augment from "virtual:starlight-social-icon-augment";
import { Icon } from "@astrojs/starlight/components";
import type { ComponentProps } from "astro/types";

type IconProps = ComponentProps<typeof Icon>;

const customIcons = {
    modrinth:
        '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 512 514" data-v-e46f41c7=""><path fill="currentColor" fill-rule="evenodd" d="M503.16 323.56c11.39-42.09 12.16-87.65.04-132.8C466.57 54.23 326.04-26.8 189.33 9.78 83.81 38.02 11.39 128.07.69 230.47h43.3c10.3-83.14 69.75-155.74 155.76-178.76 106.3-28.45 215.38 28.96 253.42 129.67l-42.14 11.27c-19.39-46.85-58.46-81.2-104.73-95.83l-7.74 43.84c36.53 13.47 66.16 43.84 77 84.25 15.8 58.89-13.62 119.23-67 144.26l11.53 42.99c70.16-28.95 112.31-101.86 102.34-177.02l41.98-11.23a210.2 210.2 0 0 1-3.86 84.16z" clip-rule="evenodd"></path><path fill="currentColor" d="M321.99 504.22C185.27 540.8 44.75 459.77 8.11 323.24A257.6 257.6 0 0 1 0 275.46h43.27c1.09 11.91 3.2 23.89 6.41 35.83 3.36 12.51 7.77 24.46 13.11 35.78l38.59-23.15c-3.25-7.5-5.99-15.32-8.17-23.45-24.04-89.6 29.2-181.7 118.92-205.71 17-4.55 34.1-6.32 50.8-5.61L255.19 133c-10.46.05-21.08 1.42-31.66 4.25-66.22 17.73-105.52 85.7-87.78 151.84 1.1 4.07 2.38 8.04 3.84 11.9l49.35-29.61-14.87-39.43 46.6-47.87 58.9-12.69 17.05 20.99-27.15 27.5-23.68 7.45-16.92 17.39 8.29 23.07s16.79 17.84 16.82 17.85l23.72-6.31 16.88-18.54 36.86-11.67 10.98 24.7-38.03 46.63-63.73 20.18-28.58-31.82-49.82 29.89c25.54 29.08 63.94 45.23 103.75 41.86l11.53 42.99c-59.41 7.86-117.44-16.73-153.49-61.91l-38.41 23.04c50.61 66.49 138.2 99.43 223.97 76.48 61.74-16.52 109.79-58.6 135.81-111.78l42.64 15.5c-30.89 66.28-89.84 118.94-166.07 139.34"></path></svg>',
} as const;

const combinedLinks: {
    main: { label: string; href: string; icon: IconProps["name"] }[];
    custom: { label: string; href: string; icon: keyof typeof customIcons }[];
} = { main: config.social || [], custom: augment || [] };
---

{
    combinedLinks.main.length > 0 && (
        <>
            {combinedLinks.main.map(({ label, href, icon }) => (
                <a {href} rel="me" class="sl-flex">
                    <span class="sr-only">{label}</span>
                    <Icon name={icon} />
                </a>
            ))}
        </>
    )
}
{
    combinedLinks.custom.length > 0 && (
        <>
            {combinedLinks.custom.map(({ label, href, icon }) => (
                <a {href} rel="me" class="sl-flex">
                    <span class="sr-only">{label}</span>
                    <Fragment set:html={customIcons[icon]} />
                </a>
            ))}
        </>
    )
}

<style>
    @layer starlight.core {
        a {
            color: var(--sl-color-text-accent);
            padding: 0.5em;
            margin: -0.5em;
        }
        a:hover {
            opacity: 0.66;
        }
    }
</style>
